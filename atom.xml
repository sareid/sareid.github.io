<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[andrew does his best]]></title>
  <link href="http://sareid.github.io/atom.xml" rel="self"/>
  <link href="http://sareid.github.io/"/>
  <updated>2016-07-15T22:51:49-04:00</updated>
  <id>http://sareid.github.io/</id>
  <author>
    <name><![CDATA[Andrew Reid]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Query Params, Metadata and Pagination in Ember.js]]></title>
    <link href="http://sareid.github.io/blog/2016/07/13/using-query-params-in-ember-dot-js/"/>
    <updated>2016-07-13T14:09:31-04:00</updated>
    <id>http://sareid.github.io/blog/2016/07/13/using-query-params-in-ember-dot-js</id>
    <content type="html"><![CDATA[<p>A little earlier this year, I was reading an organisation&rsquo;s style guide for working with Ember.js, when I encountered reference to the use of &lsquo;query params&rsquo; in a controller. At the time, still relatively new to Ember, I had no idea what this meant. In the intervening time, though I&rsquo;ve learned a lot. Basically, query params allow for certain application states to be serialised into the URL that wouldn&rsquo;t be otherwise possible through the regular use of routes. In this blog post, I&rsquo;m going to explain the role of query params, and how they can be used in your Ember app to provide some neat functionality. I&rsquo;ll be using a sample Ember.js front-end app, with a Rails API on the back-end.<!--more--></p>

<h3>Query Param Basics</h3>

<p>Consider the following URL: <code>http://www.fakewebsite.com/recipes?page=2</code>. The text to the right of the &lsquo;?&rsquo; is a query param - in this case &lsquo;page&rsquo;, with a value of 2. As you might guess, this url represents the second &lsquo;page&rsquo; of a longer list of recipes. If you had 1000 recipes in your database, you can understand the utility for paginating the index page into smaller chunks. The user probably finds it easier to read a smaller number of recipes, from a UX perspective it may be preferable to avoid scrolling through long lists, and if there is any heavy logic being done on the back-end, it&rsquo;s faster to simply request 10, 25 or 50 entries at a time than the full 1000. Other uses for query params can include sorting and filtering your database according to certain properties.</p>

<p>Query params are declared in the relevant controller of the route you&rsquo;re working with. So, if you want query params for a &lsquo;recipes&rsquo; route, the query params are declared in <code>app/controllers/recipes.js</code> (or the <code>controller.js</code> file in the <code>recipes</code> directory if you&rsquo;re working with pods). Specific instructions for declaring query params can be <a href="https://guides.emberjs.com/v2.6.0/routing/query-params/">found in the Ember docs</a>, but lets build out an app to see how they work.</p>

<h3>Getting started</h3>

<p>To test out query params, I built an Ember.js app that displays a list of friends with a number of properties (like name, email, phone number, age, etc). The data is served as JSON from a Rails API.</p>

<p>The finished code can be found here: <a href="https://github.com/sareid/query-params">Ember front-end</a> &amp; <a href="https://github.com/sareid/query-params-api">Rails API</a></p>

<h3>Setting up the Rails API and adding a root node</h3>

<p>I&rsquo;m not going to go into all the steps of setting up a Rails API. Sophie DeBenedetto has a great step-by-step guide for this on her blog <a href="http://www.thegreatcodeadventure.com/building-a-super-simple-rails-api/">here</a>. This app has a single model, Person, and a single route <code>people</code>. You can take a look at the <a href="https://github.com/sareid/query-params-api/blob/master/query-params-api/db/migrate/20160712181102_create_person.rb">migration file</a> to see the properties of the model.</p>

<p>To populate the database with entries, I wrote a <code>seed.rb</code> file that makes 400 instances of people using the <a href="https://github.com/stympy/faker">Faker gem</a> which automatically generates content for different types of properties, like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="mi">400</span><span class="o">.</span><span class="n">times</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">person</span> <span class="o">=</span> <span class="no">Person</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
</span><span class='line'>    <span class="ss">first_name</span><span class="p">:</span> <span class="no">Faker</span><span class="o">::</span><span class="no">Name</span><span class="o">.</span><span class="n">first_name</span><span class="p">,</span>
</span><span class='line'>    <span class="ss">last_name</span><span class="p">:</span> <span class="no">Faker</span><span class="o">::</span><span class="no">Name</span><span class="o">.</span><span class="n">last_name</span><span class="p">,</span>
</span><span class='line'>    <span class="ss">nick_name</span><span class="p">:</span> <span class="no">Faker</span><span class="o">::</span><span class="no">Superhero</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span class='line'>    <span class="ss">age</span><span class="p">:</span> <span class="no">Faker</span><span class="o">::</span><span class="no">Number</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">99</span><span class="p">),</span>
</span><span class='line'>    <span class="ss">email</span><span class="p">:</span> <span class="no">Faker</span><span class="o">::</span><span class="no">Internet</span><span class="o">.</span><span class="n">email</span><span class="p">,</span>
</span><span class='line'>    <span class="ss">phone</span><span class="p">:</span> <span class="no">Faker</span><span class="o">::</span><span class="no">PhoneNumber</span><span class="o">.</span><span class="n">phone_number</span><span class="p">,</span>
</span><span class='line'>    <span class="ss">friends_since</span><span class="p">:</span> <span class="no">Faker</span><span class="o">::</span><span class="no">Time</span><span class="o">.</span><span class="n">backward</span><span class="p">(</span><span class="mi">5004</span><span class="p">,</span> <span class="ss">:evening</span><span class="p">)</span>
</span><span class='line'>  <span class="p">)</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>There is one extra thing we need to do beyond Sophie&rsquo;s instructions: recent updates to the Active Model Serializer gem use the <code>Attributes</code> adapter for serializing JSON, which excludes the root node (eg, the name of the model). As such, we get JSON like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='json'><span class='line'><span class="p">{</span>
</span><span class='line'><span class="err">id:</span> <span class="err">1,</span>
</span><span class='line'><span class="err">first_name:</span> <span class="nt">&quot;Aiden&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">last_name:</span> <span class="nt">&quot;Stamm&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">nick_name:</span> <span class="nt">&quot;Doctor Match&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">age:</span> <span class="err">35,</span>
</span><span class='line'><span class="err">email:</span> <span class="nt">&quot;devan@predovicortiz.org&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">phone:</span> <span class="nt">&quot;562.135.0643 x8216&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">friends_since:</span> <span class="nt">&quot;2007-01-09T00:49:32.000Z&quot;</span>
</span><span class='line'><span class="p">}</span><span class="err">,</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'><span class="err">id:</span> <span class="err">2,</span>
</span><span class='line'><span class="err">first_name:</span> <span class="nt">&quot;Jamie&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">last_name:</span> <span class="nt">&quot;Boyer&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">nick_name:</span> <span class="nt">&quot;Songbird&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">age:</span> <span class="err">56,</span>
</span><span class='line'><span class="err">email:</span> <span class="nt">&quot;neva@hartmann.co&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">phone:</span> <span class="nt">&quot;(858) 284-7728&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">friends_since:</span> <span class="nt">&quot;2007-07-30T21:08:20.000Z&quot;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>For the model hook in Ember to function properly, we need a root node with the name of model. To do so, we need to instruct Rails to use the <code>JSON</code> adapter. In the <code>config/intializers</code> directory, I included a <code>serializer.rb</code> file with the following line of code:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">ActiveModelSerializers</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">adapter</span> <span class="o">=</span> <span class="ss">:json</span>
</span></code></pre></td></tr></table></div></figure>


<p>With that change, the JSON served by our API looks like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='json'><span class='line'><span class="err">people:</span> <span class="p">[</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'><span class="err">id:</span> <span class="err">1,</span>
</span><span class='line'><span class="err">first_name:</span> <span class="nt">&quot;Aiden&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">last_name:</span> <span class="nt">&quot;Stamm&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">nick_name:</span> <span class="nt">&quot;Doctor Match&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">age:</span> <span class="err">35,</span>
</span><span class='line'><span class="err">email:</span> <span class="nt">&quot;devan@predovicortiz.org&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">phone:</span> <span class="nt">&quot;562.135.0643 x8216&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">friends_since:</span> <span class="nt">&quot;2007-01-09T00:49:32.000Z&quot;</span>
</span><span class='line'><span class="p">},</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'><span class="err">id:</span> <span class="err">2,</span>
</span><span class='line'><span class="err">first_name:</span> <span class="nt">&quot;Jamie&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">last_name:</span> <span class="nt">&quot;Boyer&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">nick_name:</span> <span class="nt">&quot;Songbird&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">age:</span> <span class="err">56,</span>
</span><span class='line'><span class="err">email:</span> <span class="nt">&quot;neva@hartmann.co&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">phone:</span> <span class="nt">&quot;(858) 284-7728&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">friends_since:</span> <span class="nt">&quot;2007-07-30T21:08:20.000Z&quot;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>That&rsquo;s great for now - our API is serving JSON. Let&rsquo;s set up our Ember front-end.</p>

<h3>Building an Ember app and connecting it to the API</h3>

<p>To start, generate a new Ember app with the <code>ember new</code> command (for more, <a href="https://guides.emberjs.com/v2.6.0/getting-started/quick-start/#toc_create-a-new-application">see the Ember docs</a>).</p>

<p>In this project, I just wanted to build an index page for all the people in the database. As such, we need to set up the route, model, route handler, template and controller for &lsquo;people&rsquo; (fun note: the Inflector in Rails is smart enough to know that &lsquo;people&rsquo; is the plural of &lsquo;person&rsquo;). Run <code>ember g resource people</code>. This creates three important files: <code>app/models/person.js</code>, <code>app/routes/people.js</code>, and <code>app/templates/people.hbs</code> (as well as a file for tests). It also adds the appropriate route - if you look in your <code>app/router.js</code> file you&rsquo;ll see the following:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">&#39;ember&#39;</span><span class="p">;</span>
</span><span class='line'><span class="kr">import</span> <span class="nx">config</span> <span class="nx">from</span> <span class="s1">&#39;./config/environment&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="kr">const</span> <span class="nx">Router</span> <span class="o">=</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Router</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">location</span><span class="o">:</span> <span class="nx">config</span><span class="p">.</span><span class="nx">locationType</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="nx">Router</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">route</span><span class="p">(</span><span class="s1">&#39;people&#39;</span><span class="p">);</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="kr">export</span> <span class="k">default</span> <span class="nx">Router</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>If we run our server (<code>ember s</code>) we can navigate to <code>http://localhost:4200/people</code>. There&rsquo;s nothing there yet, of course, but it&rsquo;s a route! We need to fill out a few more things before our Ember app can actually make requests to our Rails API. First, lets build out the rest of the &lsquo;people&rsquo; resource.</p>

<p>We need to define the &lsquo;person&rsquo; model and the types of properties that will provided by our API. In <code>app\models\person.js</code> we add the following:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kr">import</span> <span class="nx">DS</span> <span class="nx">from</span> <span class="s1">&#39;ember-data&#39;</span><span class="p">;</span>
</span><span class='line'><span class="kr">import</span> <span class="nx">attr</span> <span class="nx">from</span> <span class="s1">&#39;ember-data/attr&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="kr">export</span> <span class="k">default</span> <span class="nx">DS</span><span class="p">.</span><span class="nx">Model</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">first_name</span><span class="o">:</span> <span class="nx">attr</span><span class="p">(),</span>
</span><span class='line'>  <span class="nx">last_name</span><span class="o">:</span> <span class="nx">attr</span><span class="p">(),</span>
</span><span class='line'>  <span class="nx">nick_name</span><span class="o">:</span> <span class="nx">attr</span><span class="p">(),</span>
</span><span class='line'>  <span class="nx">age</span><span class="o">:</span> <span class="nx">attr</span><span class="p">(),</span>
</span><span class='line'>  <span class="nx">email</span><span class="o">:</span> <span class="nx">attr</span><span class="p">(),</span>
</span><span class='line'>  <span class="nx">phone</span><span class="o">:</span> <span class="nx">attr</span><span class="p">(),</span>
</span><span class='line'>  <span class="nx">friends_since</span><span class="o">:</span> <span class="nx">attr</span><span class="p">(),</span>
</span><span class='line'>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>We then need to add a model hook to the &lsquo;people&rsquo; route handler that will load the model from the store. In the <code>app\routes\people.js</code> we add the following:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">&#39;ember&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="kr">export</span> <span class="k">default</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Route</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">model</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">store</span><span class="p">.</span><span class="nx">findAll</span><span class="p">(</span><span class="s1">&#39;person&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>For the moment, we don&rsquo;t need to add anything new to our controller, but we do need to fill out the <code>app/templates/people.hbs</code> template a bit. To make our front-end styling a little simpler, I&rsquo;m using the <a href="http://foundation.zurb.com/">Zurb Foundation</a> responsive framework. Don&rsquo;t worry if you don&rsquo;t understand how it works. I installed into my Ember app using the <a href="https://github.com/nadavshatz/ember-cli-foundation-sass">Ember Cli Foundation Sass addon</a>.</p>

<p>In the template, I build a table of all the people in our database using the <code>{ {#each model as |person|} }</code> helper. It looks like this (ignore the spaces between the curly braces):</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="o">&lt;</span><span class="nx">table</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="nx">thead</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">th</span><span class="o">&gt;</span><span class="nx">First</span> <span class="nx">Name</span><span class="o">&lt;</span><span class="err">/th&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">th</span><span class="o">&gt;</span><span class="nx">Last</span> <span class="nx">Name</span><span class="o">&lt;</span><span class="err">/th&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">th</span><span class="o">&gt;</span><span class="nx">Nickname</span><span class="o">&lt;</span><span class="err">/th&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">th</span><span class="o">&gt;</span><span class="nx">Age</span><span class="o">&lt;</span><span class="err">/th&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">th</span><span class="o">&gt;</span><span class="nx">Email</span><span class="o">&lt;</span><span class="err">/th&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">th</span><span class="o">&gt;</span><span class="nx">Phone</span><span class="o">&lt;</span><span class="err">/th&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">th</span><span class="o">&gt;</span><span class="nx">Friends</span> <span class="nx">Since</span><span class="o">&lt;</span><span class="err">/th&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="err">/thead&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="nx">tbody</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="p">{</span> <span class="p">{</span><span class="err">#</span><span class="nx">each</span> <span class="nx">model</span> <span class="nx">as</span> <span class="o">|</span><span class="nx">person</span><span class="o">|</span><span class="p">}</span> <span class="p">}</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">tr</span><span class="o">&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">td</span><span class="o">&gt;</span><span class="p">{</span> <span class="p">{</span><span class="nx">person</span><span class="p">.</span><span class="nx">first_name</span><span class="p">}</span> <span class="p">}</span><span class="o">&lt;</span><span class="err">/td&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">td</span><span class="o">&gt;</span><span class="p">{</span> <span class="p">{</span><span class="nx">person</span><span class="p">.</span><span class="nx">last_name</span><span class="p">}</span> <span class="p">}</span><span class="o">&lt;</span><span class="err">/td&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">td</span><span class="o">&gt;</span><span class="p">{</span> <span class="p">{</span><span class="nx">person</span><span class="p">.</span><span class="nx">nick_name</span><span class="p">}</span> <span class="p">}</span><span class="o">&lt;</span><span class="err">/td&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">td</span><span class="o">&gt;</span><span class="p">{</span> <span class="p">{</span><span class="nx">person</span><span class="p">.</span><span class="nx">age</span><span class="p">}</span> <span class="p">}</span><span class="o">&lt;</span><span class="err">/td&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">td</span><span class="o">&gt;</span><span class="p">{</span> <span class="p">{</span><span class="nx">person</span><span class="p">.</span><span class="nx">email</span><span class="p">}</span> <span class="p">}</span><span class="o">&lt;</span><span class="err">/td&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">td</span><span class="o">&gt;</span><span class="p">{</span> <span class="p">{</span><span class="nx">person</span><span class="p">.</span><span class="nx">phone</span><span class="p">}</span> <span class="p">}</span><span class="o">&lt;</span><span class="err">/td&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">td</span><span class="o">&gt;</span><span class="p">{</span> <span class="p">{</span><span class="nx">person</span><span class="p">.</span><span class="nx">friends_since</span><span class="p">}</span> <span class="p">}</span><span class="o">&lt;</span><span class="err">/td&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="err">/tr&gt;</span>
</span><span class='line'>    <span class="p"></span>
</span><span class='line'>  <span class="o">&lt;</span><span class="err">/tbody&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="err">/table&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>If we navigate to <code>http://localhost:4200/people</code> we can see our table rendered with the people in our database! That&rsquo;s great. Though, with 400 entries in the database, it involves a LOT of scrolling:</p>

<div style='position:relative;padding-bottom:calc(100% / 1.60)'><iframe src='https://gfycat.com/ifr/TiredHeavyAidi' frameborder='0' scrolling='no' width='100%' height='100%' style='position:absolute;top:0;left:0;' allowfullscreen></iframe></div>


<p>Ideally, we&rsquo;d like to see things in smaller chunks - that&rsquo;s the whole point of this blog post, afterall! To do this, we need to go back to our API and include some metadata about pagination in the JSON being served.</p>

<h3>Paginating JSON and serving metadata</h3>

<p>When a GET request is sent to the <code>api/v1/people</code> route of our API, the back-end is currently serving all 400 entries back as a response. We need a way to both break the JSON being served into smaller segments, but also to serve information about the data itself (metadata). In the case of pagination, this metadata will include information like how many chunks or &lsquo;pages&rsquo; the database has been segmented into, as well as the current page being served.</p>

<p>The simplest way to incorpate pagination into your API is through the <a href="https://github.com/amatsuda/kaminari">Kaminari gem</a>. There are other options out there, but the comments I&rsquo;ve seen on Stack Overflow and elsewhere seem to favour this gem. Install it by including <code>gem 'kaminari'</code> in your Gemfile, and running <code>$ bundle</code>. With this done, we need to make some changes to our People Controller, as follows:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Api</span><span class="o">::</span><span class="no">V1</span><span class="o">::</span><span class="no">PeopleController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">index</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">info</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>      <span class="ss">page</span><span class="p">:</span> <span class="n">params</span><span class="o">[</span><span class="ss">:page</span><span class="o">]</span> <span class="o">||</span> <span class="mi">1</span><span class="p">,</span>
</span><span class='line'>      <span class="ss">per_page</span><span class="p">:</span> <span class="n">params</span><span class="o">[</span><span class="ss">:per_page</span><span class="o">]</span> <span class="o">||</span> <span class="mi">10</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="vi">@people</span> <span class="o">=</span> <span class="no">Person</span><span class="o">.</span><span class="n">page</span><span class="p">(</span><span class="n">info</span><span class="o">[</span><span class="ss">:page</span><span class="o">]</span><span class="p">)</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">info</span><span class="o">[</span><span class="ss">:per_page</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">render</span> <span class="ss">json</span><span class="p">:</span> <span class="vi">@people</span><span class="p">,</span> <span class="ss">params</span><span class="p">:</span> <span class="n">info</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>The info hash sets defaults for the current page, as well as the number of entries per page. Eventually, params included in requests from the Ember app will include the page number, which is what is being used when the Person model is being queried to create the <code>@people</code> variable being rendered as JSON. If we go to <code>http://localhost:3000/people</code>, we&rsquo;ll see that only 10 entries are being served in the JSON. If we got to <code>http://localhost:3000/api/v1/people?page=2</code> we see the next 10 in the database. Cool!</p>

<p>But that&rsquo;s not all - we also need to serve the metadata, telling the Ember app things like which page we&rsquo;re on and how many pages there currently are. Looking at the <a href="https://github.com/rails-api/active_model_serializers/blob/master/docs/howto/add_pagination_links.md#json-adapter">documentation for Active Model Serializer</a>, the solution is quite simple. In our API controller (effectively the application controller), we add the following:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">pagination_dict</span><span class="p">(</span><span class="n">object</span><span class="p">)</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>    <span class="ss">current_page</span><span class="p">:</span> <span class="n">object</span><span class="o">.</span><span class="n">current_page</span><span class="p">,</span>
</span><span class='line'>    <span class="ss">next_page</span><span class="p">:</span> <span class="n">object</span><span class="o">.</span><span class="n">next_page</span><span class="p">,</span>
</span><span class='line'>    <span class="ss">prev_page</span><span class="p">:</span> <span class="n">object</span><span class="o">.</span><span class="n">prev_page</span><span class="p">,</span> <span class="c1"># use object.previous_page when using will_paginate</span>
</span><span class='line'>    <span class="ss">total_pages</span><span class="p">:</span> <span class="n">object</span><span class="o">.</span><span class="n">total_pages</span><span class="p">,</span>
</span><span class='line'>    <span class="ss">total_count</span><span class="p">:</span> <span class="n">object</span><span class="o">.</span><span class="n">total_count</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>And in our People Controller, we make a small addition to the code rendering our JSON:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Api</span><span class="o">::</span><span class="no">V1</span><span class="o">::</span><span class="no">PeopleController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">index</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">info</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>      <span class="ss">page</span><span class="p">:</span> <span class="n">params</span><span class="o">[</span><span class="ss">:page</span><span class="o">]</span> <span class="o">||</span> <span class="mi">1</span><span class="p">,</span>
</span><span class='line'>      <span class="ss">per_page</span><span class="p">:</span> <span class="n">params</span><span class="o">[</span><span class="ss">:per_page</span><span class="o">]</span> <span class="o">||</span> <span class="mi">10</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="vi">@people</span> <span class="o">=</span> <span class="no">Person</span><span class="o">.</span><span class="n">page</span><span class="p">(</span><span class="n">info</span><span class="o">[</span><span class="ss">:page</span><span class="o">]</span><span class="p">)</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">info</span><span class="o">[</span><span class="ss">:per_page</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">render</span> <span class="ss">json</span><span class="p">:</span> <span class="vi">@people</span><span class="p">,</span> <span class="ss">params</span><span class="p">:</span> <span class="n">info</span><span class="p">,</span> <span class="ss">meta</span><span class="p">:</span> <span class="n">pagination_dict</span><span class="p">(</span><span class="vi">@people</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Our JSON now has a &lsquo;meta&rsquo; key attached to the end, like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='json'><span class='line'><span class="err">meta:</span> <span class="p">{</span>
</span><span class='line'><span class="err">current_page:</span> <span class="err">1,</span>
</span><span class='line'><span class="err">next_page:</span> <span class="err">2,</span>
</span><span class='line'><span class="err">prev_page:</span> <span class="err">null,</span>
</span><span class='line'><span class="err">total_pages:</span> <span class="err">40,</span>
</span><span class='line'><span class="err">total_count:</span> <span class="err">400</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>We&rsquo;ll be able to execute a query for this in the People route handler in Ember, giving us access to this metadata in the view. So, now it&rsquo;s time to head back to the Ember app!</p>

<h3>Handling metadata and pagination in Ember</h3>

<p>We need to do a number of steps to handle and use the metadata being served with our JSON in Ember. First, we go to the route handler and change the code to the following:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">&#39;ember&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="kr">export</span> <span class="k">default</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Route</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">queryParams</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">page</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">refreshModel</span><span class="o">:</span> <span class="kc">true</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">model</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">params</span><span class="p">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">store</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;person&#39;</span><span class="p">,</span> <span class="nx">params</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>We&rsquo;ve done a couple of things here. The queryParams property includes a key called &lsquo;page&rsquo;. By setting the refreshModel property to &lsquo;true&rsquo;, any changes to the page query param will fire the model hook and make a new request to the API. So if the url is changed from <code>http://localhost:4200/people</code> to <code>http://localhost:4200/people?page=2</code>, the model will be updated automatically.</p>

<p>Next, we need to actually declare our &lsquo;page&rsquo; query param in the <code>app/controllers/people.js</code> file, and give it some logic.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">&#39;ember&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="kr">export</span> <span class="k">default</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Controller</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">queryParams</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;page&#39;</span><span class="p">],</span>
</span><span class='line'>  <span class="nx">page</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">metaData</span><span class="o">:</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">computed</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>    <span class="kd">let</span> <span class="nx">meta</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;model.meta&#39;</span><span class="p">);</span>
</span><span class='line'>    <span class="nx">meta</span><span class="p">[</span><span class="s1">&#39;second_last&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">meta</span><span class="p">.</span><span class="nx">total_pages</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">meta</span><span class="p">[</span><span class="s1">&#39;third_last&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">meta</span><span class="p">.</span><span class="nx">total_pages</span> <span class="o">-</span> <span class="mi">2</span><span class="p">;</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">meta</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}),</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">lastThreePages</span><span class="o">:</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">computed</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;page&#39;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;metaData.total_pages&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}),</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">actions</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">nextPage</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;page&#39;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;metaData.total_pages&#39;</span><span class="p">)){</span>
</span><span class='line'>        <span class="kd">let</span> <span class="nx">page</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;page&#39;</span><span class="p">);</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;page&#39;</span><span class="p">,</span> <span class="nx">page</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">prevPage</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;page&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;page&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;page&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>So what&rsquo;s going on here? First, the <code>queryParams</code> array is defining which specific query params we&rsquo;ll be using. In this case, just one: &lsquo;page&rsquo;. The &lsquo;page&rsquo; property below it gives it a default value of 1 - so if we navigate to just <code>http://localhost:4200/people</code>, it will assume we want the first page.</p>

<p>In the <code>metaData</code> computed property, we are accessing the information in the &lsquo;meta&rsquo; key in the JSON our API is serving, giving us access in the view to information like the current page, which we can invoke with <code>metaData.current_page</code>.</p>

<p>There are also a pair of actions: <code>nextPage</code> and <code>prevPage</code>. These do pretty much what you&rsquo;re thinking they will: when triggered, it will change the &lsquo;page&rsquo; query param to the next or previous page, thus updating the model and serving new entries from the database in our view. In the template we&rsquo;ll have two buttons that trigger these actions. We use conditional statements to make sure we can&rsquo;t advance past the last page in the database, or to a page number lower than 1.</p>

<p>Don&rsquo;t worry about the &lsquo;lastThreePages&rsquo; computed property for now - I&rsquo;m adding the pagination system available in Zurb Foundation, and we&rsquo;ll use that property for some conditionals in the view to change how certain buttons are rendered depending on which page we&rsquo;re on.</p>

<p>So, let&rsquo;s add that to our <code>app/templates/people.hbs</code> files and see what we get. In the template, below the original code for the table, we add new code for pagination buttons. Normally we might choose to separate this into a component, but for time&rsquo;s sake I&rsquo;ve just included it in the template itself. The code is a bit lengthy and not particularly important to what this blog is about. If you&rsquo;d like to see it, it&rsquo;s in <a href="https://github.com/sareid/query-params/blob/master/app/templates/people.hbs">the repository here,</a> but I am also certain there are more elegant ways of doing it.</p>

<p>With that all in place, we get something that looks like this:</p>

<div style='position:relative;padding-bottom:calc(100% / 1.60)'><iframe src='https://gfycat.com/ifr/MarvelousMarvelousDogwoodclubgall' frameborder='0' scrolling='no' width='100%' height='100%' style='position:absolute;top:0;left:0;' allowfullscreen></iframe></div>


<p>As the buttons on the bottom are pressed, the &lsquo;nextPage&rsquo; function is triggered, updating the &lsquo;page&rsquo; query param and making a new request to our Rails API (again, because we set the <code>refreshModel</code> property to &lsquo;true&rsquo;). The person controller in our API takes in the page parameter in the request, queries the database and serves the appropriate data and metadata back to our Ember app. The controller takes the data for the model, extracts the metadata, and then passes it to update the view.</p>

<h3>Conclusions</h3>

<p>So that&rsquo;s a first look at query params, metadata and pagination in Ember! Don&rsquo;t forget, we can use queryParams to serialise a number of different application states into our URL beyond mere pages. We have a <code>filter</code> query param that looks at a particular property and only returns instances from the database where a condition is met. In this example, maybe we filter to find friends who are a particular age. Or we could sort according to certain categories - maybe I&rsquo;d like to see my friends ranked according to how long I&rsquo;ve known them. We can accomplish all this and more with query params.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Creating page-specific JavaScript and CSS in Rails]]></title>
    <link href="http://sareid.github.io/blog/2016/04/28/creating-page-specific-javascript-and-css-in-rails/"/>
    <updated>2016-04-28T11:36:24-04:00</updated>
    <id>http://sareid.github.io/blog/2016/04/28/creating-page-specific-javascript-and-css-in-rails</id>
    <content type="html"><![CDATA[<p>The <a href="http://guides.rubyonrails.org/asset_pipeline.html">Rails Asset Pipeline</a> is a really great tool that improves performance by compressing and minifying assets, as well as compiling JS and CSS assets written in other languages, like CoffeeScript and SASS. When compiled, the files in your <code>app/assets/javascripts/</code> folder get processed and minified into a single <code>application.js</code> file. In many cases, this is great - all of the views in your app have access to this file at all times, and it cuts down on the number of server requests made by the browser. But what happens if you want to dynamicaly scope JavaScript functions to specific pages in your app, like a function that only fires when an object view page is loaded?<!--more--></p>

<p>I recently built a <a href="https://github.com/sareid/carrier-selector">small Rails app</a> as a part of an exercise in data analysis and visualisation. Using a set of On-Time performance data for flights in the United States, it visualised various performance criteria to help determine what carrier would be ideal for a New York-based company. As part of the challenge, I wanted to create maps visualising the metropolitan areas served by each carrier, and the relative population sizes of these areas. Here&rsquo;s what the end product looked like:</p>

<p><img src="http://i.imgur.com/1cLwCCb.png" alt="Example bubble map of metropolitan areas" /></p>

<p>To render these maps, I was using the <a href="https://d3js.org/">D3 JavaScript library</a>. I needed to trigger two AJAX requests to my Carrier controller for two TopoJSON files (one for the US map, and one for the metropolitan areas). The latter of these two TopoJSON files was dynamically built in the <code>carriers#data</code> controller action and was unique to each instance of the Carrier model. I wanted these AJAX functions to fire as soon as the show page was loaded.</p>

<p>The typical way to trigger a JavaScript function upon page load would be via a Document Ready function, which fires once the DOM is loaded, as such:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">$</span><span class="p">(</span> <span class="nb">document</span> <span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// Code goes here</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>However, as the Rails Asset Pipeline pre-compiles all your JavaScript and CoffeeScript files into a minified Application.js file, a Document Ready function will fire when any page in your app loads. One solution would have been to create a separate <code>carrier.js</code> file and include it manually in the Carrier show view like so:</p>

<p><code>&lt;%= javascript_include_tag "carrier" %&gt;</code></p>

<p>This would require a separate JS file to be loaded alongside the <code>application.js</code> file, and for me to add specific instructions to the <code>production.rb</code> file. This is okay, but it seemed like there should be a more elegant solution.</p>

<h3>The jQuery ReadySelector plugin</h3>

<p>Indeed, a more elegant solution exists: the <a href="https://github.com/Verba/jquery-readyselector">jQuery ReadySelector plugin</a>. This plugin extends the <code>.ready()</code> function for when a specific element of the DOM is loaded. In Rails, the suggested option is to dynamically generate class names for the <code>&lt;body&gt;</code> tags of your view matching the current controller action being used. Using ERB tags, you can achieve this with the following code:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;body</span> <span class="na">class=</span><span class="s">&quot;&lt;%= controller_name -%&gt; &lt;%= action_name -%&gt;&quot;</span><span class="nt">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>With this in place, all of my Carrier show pages were rendered inside of <code>&lt;body class="carriers show"&gt;</code> tags. In my <code>carriers.js</code> file, I included the following code that would trigger the relevant AJAX requests whenever a carrier show page was loaded:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.carriers.show&#39;</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
</span><span class='line'>    <span class="nx">type</span><span class="o">:</span> <span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">contentType</span><span class="o">:</span> <span class="s2">&quot;application/json; charset=utf-8&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">data</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="o">:</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#metro-map&#39;</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;params-id&#39;</span><span class="p">)},</span>
</span><span class='line'>    <span class="nx">dataType</span><span class="o">:</span> <span class="s1">&#39;json&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">success</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">$</span><span class="p">.</span><span class="nx">getJSON</span><span class="p">(</span><span class="s1">&#39;usData&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">usData</span><span class="p">){</span>
</span><span class='line'>        <span class="nx">draw</span><span class="p">(</span><span class="nx">usData</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
</span><span class='line'>      <span class="p">})</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>      <span class="nx">error</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">error</span><span class="p">();</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'><span class="p">})</span>
</span></code></pre></td></tr></table></div></figure>


<p>A few notes to explain what is happening. This function makes an AJAX request to the <code>#data</code> action in the Carrier controller, which serves back a topoJSON file. You&rsquo;ll note it uses the &lsquo;data&rsquo; field to pass the ID of the specific carrier to controller. I did this by using ERB tags to generate a custom data attribute in the <code>&lt;div&gt;</code> tag of the column I was appending the D3 map too. The value of this attribute corresponded to the ID of the carrier in question. The code for that looked like this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;col-lg-12 text-center&quot;</span> <span class="na">id=</span><span class="s">&quot;metro-map&quot;</span> <span class="err">&lt;%=</span> <span class="err">&quot;</span><span class="na">data-params-id=</span><span class="s">#{params[:id]}&quot;</span> <span class="na">if</span> <span class="na">params</span><span class="err">.</span><span class="na">has_key</span><span class="err">?(</span><span class="na">:id</span><span class="err">)</span> <span class="err">%</span><span class="nt">&gt;</span>&gt;
</span></code></pre></td></tr></table></div></figure>


<p>The AJAX request uses the <code>.data()</code> function to pass the ID to the controller, which is able to query the database for the carrier in question, and then serve back the needed topoJSON. Upon a successful AJAX request, a second AJAX request is fired to the Carrier controller, this time serving back a static JSON with the information needed to render the map of the USA. The rest of the JavaScript code for rendering the D3 map can be <a href="https://github.com/sareid/carrier-selector/blob/master/app/assets/javascripts/carriers.js.erb">seen here</a>.</p>

<h3>Conclusion</h3>

<p>As you can see, this is a pretty neat trick for scoping your JavaScript to a particular type of view in your Rails app. Using dynamically generated class attributes in your <code>&lt;body&gt;</code> tag, you can have as many specific JavaScript <code>.ready()</code> functions as you have controller actions and views. And don&rsquo;t forget - with these dynamic class attributes, you can also create corresponding custom CSS for particular views too.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[The People v Turbolinks]]></title>
    <link href="http://sareid.github.io/blog/2016/01/27/the-people-vs-turbolinks/"/>
    <updated>2016-01-27T07:40:57-05:00</updated>
    <id>http://sareid.github.io/blog/2016/01/27/the-people-vs-turbolinks</id>
    <content type="html"><![CDATA[<p>This week, as part of the Flatiron Students Present series I gave a presentation on the new features coming in <a href="http://weblog.rubyonrails.org/2015/12/18/Rails-5-0-beta1/">Rails 5.</a>. There&rsquo;s some really intriguing stuff, highlighted by the Railsified websocket goodness of <a href="https://github.com/rails/rails/tree/master/actioncable">Action Cable</a>. Nestled in there is the news of <s>Turbolinks 3</s> Turbolinks 5, the latest version of a Rails feature I was totally unfamiliar with.<!--more--></p>

<p>I was interested to learn more about this unfamiliar thing, so I turned on my internet and delved into some documentation and blogs on the topic, prepared to learn a cool new thing. But I was suprised by what I found: <a href="http://staal.io/blog/2013/01/18/dangers-of-turbolinks/.">criticism.</a> <a href="https://plus.google.com/+YehudaKatz/posts/A65agXRynUn">A lot.</a> <a href="http://railscasts.com/episodes/390-turbolinks?view=comments">Of.</a> <a href="https://www.reddit.com/r/rails/comments/30yj2s/what_are_some_arguments_against_turbolinks/">Criticism.</a></p>

<p>People hate Turbolinks. Like&hellip;a whole bunch. Even people who otherwise love Rails. It&rsquo;s like Rails is the Backstreet Boys and Turbolinks is Kevin.</p>

<p><img src="http://i.imgur.com/UWuJDkQ.jpg" alt="Kevin Richardson was not a beloved Backstreet Boy" /></p>

<p>Hell, even the creator of Rails seemingly understands the state of Turbolinks, as evidenced by the way he <a href="https://www.youtube.com/watch?v=KJVTM7mE1Cc&amp;feature=youtu.be&amp;t=1660">broached the subject in his 2015 Railsconf keynote speech.</a></p>

<p><img src="http://i.imgur.com/2zB8f1E.png" alt="David Heinemeier Hensen introducing Turbolinks 3" /></p>

<p>Clearly there&rsquo;s a lot of antipathy directed towards Turbolinks, but why? I think it&rsquo;s important to understand why bad things are bad, either to help fix them or to avoid making the same mistakes again. So in today&rsquo;s blogpost, I&rsquo;m going to be taking a deeper look into the bleak edge of hell that is the world of Turbolinks.</p>

<h3>Understanding Turbolinks.</h3>

<p>So, what do Turbolinks do? From the source:</p>

<blockquote><p>Turbolinks makes following links in your web application faster. Instead of letting the browser recompile the JavaScript and CSS between each page change, it keeps the current page instance alive and replaces only the body (or parts of) and the title in the head.</p><footer><strong>ReadMe</strong> <cite><a href='https://github.com/rails/turbolinks'>Turbolinks on Github</a></cite></footer></blockquote>


<p>That&rsquo;s rad, right? I want to make my links faster! And thats great that I don&rsquo;t need to redownload my CSS and JS resources each time I click a link. It seems to me like that would be great for the user experience, especially on mobile devices.</p>

<p>Delving deeper into the nitty-gritty, Turbolinks takes over any llink, sends an AJAX request for the content, and replaces the <code>&lt;body&gt;</code> on your current page with that fresh new content. It&rsquo;s basically a PJAX request - a portmonteau of <code>pushState</code> and <code>AJAX</code>.</p>

<h3>Abandon all hope ye who Turbolink here</h3>

<p>So, as I indicated at the top of this blog, there has been a lot of criticism directed towards Turbolinks. It&rsquo;s like it&rsquo;s the worst thing on the internet.</p>

<p>&hellip;so, in the spirit of &lsquo;terrible things that exist on the internet&rsquo;, here&rsquo;s a Buzzfeed-style Listicle of 7 bad things about Turbolinks.</p>

<h4>1. Document ready event.</h4>

<p><img src="http://4.bp.blogspot.com/-6nfZppXwU-8/UzmIKYHEdQI/AAAAAAAAVN8/cRJBP35197k/s1600/Marshall.gif" alt="not ready for this" /></p>

<p>If you&rsquo;ve spent any time with JavaScript, then you&rsquo;ve seen the document ready event. It looks something like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">$</span><span class="p">(</span> <span class="nb">document</span> <span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="s2">&quot;ready!&quot;</span> <span class="p">);</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>Simply put, it&rsquo;s a function that is triggered once your document is ready (eg: all your resources have loaded, the DOM is in place, etc). It&rsquo;s really helpful for a lot of things, and let&rsquo;s you ensure that none of your JavaScript functions are triggered before you want them to, which could cause problems especially if the user is manipulating elements in the document before its fully ready.</p>

<p>Unfortunately, Turbolinks don&rsquo;t call this event, as they aren&rsquo;t calling a direct page reload. Think of all the things that we might include within a document ready event, like .click() listeners. You could end up with a totally inert and non-functional page.</p>

<p>There are gem workarounds (eg: for <a href="https://github.com/kossnocorp/jquery.turbolinks">jQuery</a>), but the problem is there and needs to be addressed on a case by case basis.</p>

<h4>2. Global scope does not get wiped.</h4>

<p><img src="https://media.giphy.com/media/w0h5LmXICRdEA/giphy.gif" alt="scope commercial" /></p>

<p>Turbolinks claims to save time by not reloading your assets. This is true. But assets aren&rsquo;t the only thing that remain. The global scope is saved too, meaning that even when it seems like Turbolinks has reloaded a new page, your JavaScript scope is persisting.  This is problematic because a lot of JavaScript is written under the assumption that global scope is wiped clean everytime a new page is loaded. This can lead to some wonky results with your scripts, as, for example, multiple bindings can pile up on each other.</p>

<p><a href="https://github.com/rails/turbolinks/issues/87">Here&rsquo;s an example</a> of someone trouble shooting this very issue. In their case, buttons that look like this on your initial page load:</p>

<p><img src="http://content.screencast.com/users/pomartel/folders/Jing/media/d006b968-66fd-4e3f-a38b-27dbf8da053d/00000012.png" alt="button issue" /></p>

<p>&hellip;ended up looking this after a Turbolink is used:</p>

<p><img src="http://content.screencast.com/users/pomartel/folders/Jing/media/ebcd3706-c1f7-40e7-aa6d-7541045eb1ce/00000014.png" alt="button issue 2" /></p>

<h4>3. SERIOUSLY GUYS. GLOBAL SCOPE DOES NOT GET WIPED.</h4>

<p><img src="https://media.giphy.com/media/Gv7i18CFKK1xK/giphy.gif" alt="seriously" /></p>

<p>I&rsquo;m restating this because it bears restating. GLOBAL SCOPE DOESN&rsquo;T GET WIPED. You can catch a lot of the issues related to things like bindings and avoid them in your code. But there are more complicated issues. For example, a lot of Backbone applications use <code>window</code> as a global namespace to store variable instances, like a collection, model or view.</p>

<p>This means that as you reload a page with Turbolinks, that collection, model or view persist even as new Backbone applications load, leading to all sorts of failures related to incorrect data or inapplicable DOM event bindings. FUN STUFF Turbolinks.</p>

<p>There are many other issues - like timers and intervals not resetting - but the point stands: Turbolinks not wiping the global scope is a huge bummer.</p>

<h4>4. Memory issues</h4>

<p><img src="http://49.media.tumblr.com/tumblr_m2ojlk0unA1r4dyzwo1_500.gif" alt="memories" /></p>

<p>Another issue relates to memory usage. Turbolinks stores the DOM trees of the last 10 pages you&rsquo;ve loaded. Typically, we are able to &lsquo;forget&rsquo; JavaScript applications as we move through a website by automatically destroying things that are not directly referenced.</p>

<p>But Turbolinks saves those DOMS. And those DOMS have bindings. And those bindings reference applications&hellip;meaning that it&rsquo;s possible for your Turbolinks to cause your application to use up to 10x the RAM that it would otherwise. Neato.</p>

<p>Oh&hellip;also&hellip;the fact that it remembers those DOMs, bindings and applications is also likely to break your app when you go back a page. Double neato.</p>

<h4>5. Not necessarily better than AJAX.</h4>

<p><img src="https://media.giphy.com/media/M5IasgJaB9CXm/giphy.gif" alt="not better" /></p>

<p>In many cases, Turbolinks can be slower than an AJAX call, as Turbolinks returns fully rendered views of the website, rather than a smaller, more targeted string that can be added to your page where you want.</p>

<h4>6. Problems with CoffeeScript</h4>

<p><img src="https://media.giphy.com/media/eWLDhSJ206rUQ/giphy.gif" alt="coffee bill murray" /></p>

<p>Another common issue relates to the use of CoffeeScript and Turbolinks. As CoffeeScript encloses your code in an anonymous function that can be triggered multiple times when using a <code>jquery.turbolinks.js</code> file.</p>

<h4>7. This programmer installed Turbolinks on their app. You&rsquo;ll never believe what happens next.</h4>

<p><img src="https://media.giphy.com/media/RtPicSw8rpiEw/giphy.gif" alt="unexpected" /></p>

<p>At the end of the day, Turbolinks is likely to bring you unexpected consequences. It can introduce the most unexpected of problems into your app, requiring lots of bug squashing, troubleshooting, stack overflow googling, and tearful calls to your parents to let them know that the chances that you&rsquo;ll have to move back in with them have gone up.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Bootstrap: Making front-end development easier since 1842 (note to self: check dates)]]></title>
    <link href="http://sareid.github.io/blog/2016/01/12/rails-and-bootstrap-like-romeo-and-juliet-with-less-murder/"/>
    <updated>2016-01-12T07:41:35-05:00</updated>
    <id>http://sareid.github.io/blog/2016/01/12/rails-and-bootstrap-like-romeo-and-juliet-with-less-murder</id>
    <content type="html"><![CDATA[<h3>Front-end frameworks</h3>

<p>Throughout the first six weeks I&rsquo;ve spent in the Flatiron School&rsquo;s Web Development immersive course, we&rsquo;ve largely stuck to the dark and bewildering world of the back-end, wading waist deep into the nitty-gritty muck and grime of SQL databases and Model View Controller designs. There&rsquo;s been a lot of plain code on plain screens.</p>

<p>But you know what? Sometimes it&rsquo;s nice to feel pretty. So today I&rsquo;m going to talk about front-end frameworks.<!--more--></p>

<p>In the same way that Rails is a framework of helpful tools for developing web-applications, front-end frameworks bring together a library of CSS, HTML and JavaScript tricks and techniques to help make the process of front-end design easier. Rather than creating default layouts and aesthetics from the ground up, they provide a jumping off point that saves you from doing spending a ton of time making sure that your <code>&lt;div&gt;</code> containers aren&rsquo;t bonkers. In short, they&rsquo;re pretty neat.</p>

<p>So let&rsquo;s look at one in particular: <a href="http://getbootstrap.com/">Bootstrap</a>.</p>

<h3>Bootstrap? What are you going on about?</h3>

<p>Bootstrap is the most popular front-end framework in use today, and has been forked over 38,000 times on Github. It began life as &lsquo;Twitter Blueprint&rsquo;, an internal project at Twitter aimed at ensuring coherence of design, and to reduce maintenance burden. The project soon escalated beyond its initial purpose as an internal tool, and in 2011 was released as an open source project. Subsequent versions (currently Version 3 with Version 4 in beta) introduced a focus on mobile design, and a flat, minimalist UI design.</p>

<p>At its core, like any framework, Bootstrap is a toolkit for you to use for your own projects. It can be downloaded as CSS and JS files that can be linked to in your HTML files like any other stylesheet or script. In fact, to reduce filesize, you can download customised versions of these files that contain only the features your want to use.</p>

<p>The <a href="http://getbootstrap.com/">Bootstrap</a> provides an extensive overview of its components, and provides example code that can be easily copied into your projects to get its features working.</p>

<p>But what are these features? Just what exactly is Bootstrap bringing to the table. In the next section, I&rsquo;ll share 5 of things I find lovely about Bootstrap.</p>

<h3>5 nifty Bootstrap features</h3>

<h4>The grid system</h4>

<p>Take a look at any site on the internet, and you are almost literally guaranteed to see the same thing: boxes. Take this very blog for example. All of the features of the site, like the header, blog articles, excerpts, and footer, are made up of different sized and shaped rectangles. This is called grid-based design, and is a pretty ubiquitous principle for web-design, some noteworthy examples not withstand cough cough the <a href="http://www.warnerbros.com/archive/spacejam/movie/jam.htm">surprisingly extant Space Jam website</a> cough cough.</p>

<p><img src="http://i.imgur.com/0OMReu3.png" alt="Some noteworth exceptions not withstandings..." /></p>

<p>A pre-built grid system facilitates quicker front-end design. Bootstrap provides a pre-built system for easily dividing your page into rows and columns. At its core, the screen is divided into 12 columns, labelled in your HTML with the <code>.col</code> class. The number at the end of your <code>.col</code> indicates the width of the particular column you are using, from 1 to 12. In the below screenshot, you can see how different column widths can be placed together. Depending on the size of the browser or screen, these columns become stackable - they automatically drop down to the row below, rather than forcing the user to scroll to the right.</p>

<p><img src="http://i.imgur.com/TjaZJor.png" alt="Example of different column class widths" /></p>

<p>Moreover, the <code>.col</code> class can also be divided altered using the <code>-xs</code>, <code>-sm</code>, <code>-md</code> or <code>-lg</code> modifier. These correspond to media queries, so that we can assign different types of layouts depending upon the device being used.</p>

<p>Your rows and columns must be wrapped within a <code>.container</code> or <code>.container-fluid</code> class. The standard container is a responsive and fixed width container, while the &lsquo;fluid&rsquo; version is full-width and spans the width of your browswer or device screen.</p>

<p>Using this system, you can quickly create a neatly organised site that acts responsively across different sized devices and viewports. In many ways, this is the biggest reason to use a front-end framwork - not just Bootstrap, but other simpler frameworks that focus only on providing grid systems.</p>

<h4>Responsive utilities</h4>

<p>As a compliment to the grid-system, Bootstrap lets you determine which HTML elements are visible or invisible, depending upon the viewport size. By adding the <code>.visible</code> or <code>.hidden</code> class with a particular size (eg. <code>-xs</code> or <code>-sm</code>), you can specifically choose what the user will see.</p>

<h4>Glyphicons</h4>

<p><a href="http://getbootstrap.com/components/#glyphicons">Link to glyphicons on Bootstrap website</a></p>

<h4>Components: Buttons, navs, breadcrumbs and junk</h4>

<p><a href="http://getbootstrap.com/components/#dropdowns">Link to components on the Bootstrap website</a></p>

<h4>More jQuery plugins than you can shake a stick at</h4>

<p><a href="http://getbootstrap.com/javascript/">Link to jQuery plugins on the Bootstrap website</a></p>

<h3>Installing Bootstrap on Rails</h3>

<p>I used Bootstrap for the design of my Sinatra project <a href="https://github.com/sareid/breddit">&lsquo;breddit&rsquo;</a>, precisely because it provided a quick way to organise the page layout into rows and columns. However, when tasked with porting the project to Rails, I had some problems getting the project o recognise my bootstrap files.</p>

<p>Luckily, as we&rsquo;ve discovered with a great many things, there&rsquo;s a gem for that. In your Gemfile, include the following:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># Gemfile</span>
</span><span class='line'>
</span><span class='line'><span class="o">.</span><span class="n">.</span><span class="o">.</span>
</span><span class='line'>
</span><span class='line'><span class="n">gem</span> <span class="s1">&#39;bootstrap-sass&#39;</span><span class="p">,</span> <span class="s1">&#39;~&gt; 3.2.0&#39;</span>
</span><span class='line'><span class="n">gem</span> <span class="s1">&#39;autoprefixer-rails&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># NOTE: The sass-rails gem is included with new Rails applications by default.</span>
</span><span class='line'><span class="c1">#       Please make sure that it is not already in your Gemfile before uncommenting it.</span>
</span><span class='line'><span class="c1"># gem &#39;sass-rails&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Next, we need to import the CSS assets into our Bootstrap CSS file. As Bootstrap uses different versions of CSS (LESS and SASS), we rename <code>app/assets/stylesheets/application.css</code> to <code>app/assets/stylesheets/application.css.sass</code>, and then add the following code:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="sr">//</span> <span class="n">app</span><span class="o">/</span><span class="n">assets</span><span class="o">/</span><span class="n">stylesheets</span><span class="o">/</span><span class="n">application</span><span class="o">.</span><span class="n">css</span><span class="o">.</span><span class="n">sass</span>
</span><span class='line'>
</span><span class='line'><span class="vi">@import</span> <span class="s2">&quot;bootstrap-sprockets&quot;</span>
</span><span class='line'><span class="vi">@import</span> <span class="s2">&quot;bootstrap&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>To import the Javascript components, go to your <code>app/assets/javascripts/application.js</code> and add the following:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="c1">// app/assets/javascripts/application.js</span>
</span><span class='line'>
</span><span class='line'><span class="p">...</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//= require jquery</span>
</span><span class='line'><span class="c1">//= require jquery_ujs</span>
</span><span class='line'><span class="c1">//= require turbolinks</span>
</span><span class='line'><span class="c1">//= require bootstrap-sprockets</span>
</span><span class='line'><span class="c1">//= require_tree .</span>
</span></code></pre></td></tr></table></div></figure>


<p>Congratulations! You&rsquo;re off to the races with Bootstrap!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[PSTORE and me: An uneasy alliance]]></title>
    <link href="http://sareid.github.io/blog/2015/12/18/pstore-and-me-an-uneasy-alliance/"/>
    <updated>2015-12-18T10:38:21-05:00</updated>
    <id>http://sareid.github.io/blog/2015/12/18/pstore-and-me-an-uneasy-alliance</id>
    <content type="html"><![CDATA[<p>EDIT: I literally wrote this post the day before I learned what SQL was. Oh the folly of youth.</p>

<h3>In the beginning&hellip;</h3>

<p>Earlier in the week, when working on a <a href="https://github.com/sareid/cli-project-week-guidelines-web-1115">little NBA player stats CLI program</a>, I had my first run in with Ruby&rsquo;s <a href="http://ruby-doc.org/stdlib-2.1.2/libdoc/pstore/rdoc/PStore.html">PSTORE class</a> - a mechanism that allows you store Ruby objects that persist between instances of the program running. <!--more--> The program we were building let you build a team of ten basketball players, and we wanted a way for the program to remember your team the next time it started up.</p>

<p>After some wrangling, I got PSTORE to work. The program could save an array of Ruby objects upon shutting down (in this case individual basketball players), and then return that same array upon the next startup. I felt great. I felt triumphant!</p>

<p>&hellip;but I got it to work in the same way that primitive man got fire to &lsquo;work&rsquo;.</p>

<p><img src="http://i.imgur.com/SPFScT0.jpg" alt="Primitive man's experience with PSTORE" /></p>

<p>Sure, those hirsute cave dwellers weren&rsquo;t freezing to death, but they also weren&rsquo;t bandying about high level concepts of thermodynamics. And so, like my primordial kin, I stared into the crackling PSTORE flames, my eyes wide with abject miscomprehension and distrust.</p>

<p>I knew what needed to be done. I needed to wade into PSTORE, to cleanse myself in its waters and emerge a  more competent, capable web developer.</p>

<h3>Cool. Wait. What is this PSTORE you speak of?</h3>

<p>So, first thing&rsquo;s first. What exactly is PSTORE? I think if you were to ask a random person on the street, they might say:</p>

<blockquote><p>PStore implements a file based persistence mechanism based on a Hash. User code can store hierarchies of Ruby objects (values) into the data store file by name (keys). An object hierarchy may be just a single object. User code may later read values back from the data store or even update data, as needed.</p></blockquote>

<p>&hellip;if by &ldquo;random person on the street&rdquo; you meant &ldquo;the Ruby documentation.&rdquo; So what does it mean? It means you can <em>&lsquo;persist data&rsquo;</em> - using PSTORE you can save Ruby objects (in our case, an array of basketball players) to be accessed during a different through a Hash-like structure. Our array was stored as the value for a key called <code>:players</code>. This hash was saved to a .pstore file included in our project.</p>

<h3>Getting started with PSTORE (or How I Learned to Stop Worrying and Love the Persistent Hash)</h3>

<p>PSTORE is part of the standard library, so it can be used by incuding by simply requiring it. No need for pesky gems or ancient voodoo incantations! After that, you need to initialise a new PSTORE object, passing the desired path of the .pstore file as the argument.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;pstore&#39;</span>
</span><span class='line'><span class="n">saved_data</span> <span class="o">=</span> <span class="no">PSTORE</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;filepath.pstore&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>The cool thing about this, is that PSTORE detects if the file already exists. If it does, it reads the data in the file and assigns it to the <code>saved_data</code> variable. If not, it creates a new file and assigns it. So, at this point, the value of <code>saved_data</code> is now a persistent hash. Neato.</p>

<p>In our case, we did that as soon as the program first started, in the first method called by our program.
Now, when you actually want to read or write to the .pstore file, you need to do within a &lsquo;transaction&rsquo;. Transactions are an instance method of the PSTORE class.</p>

<h3>Transactions - Cha-Ching!</h3>

<p>So, let&rsquo;s say we wanted to save to the .pstore file. How would we do this?</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">saved_data</span><span class="o">.</span><span class="n">transaction</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">saved_data</span><span class="o">[</span><span class="n">key_name</span><span class="o">]</span> <span class="o">=</span> <span class="o">[</span><span class="n">key_value</span><span class="o">]</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>This code assigns a value, <code>key_value</code> to a key, <code>:key_name</code> in the PSTORE hash object. The value could be an number of different types of Ruby objects. In the case of our project, it was an array of basketball players.</p>

<p>To read from the .pstore file, and assign its value to a variable that we can use in Ruby, we follow a similar strategy.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">some_variable</span> <span class="o">=</span> <span class="n">saved_data</span><span class="o">.</span><span class="n">transaction</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">saved_data</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="ss">:key_name</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>A number of things are happening here. Like the method of saving, we call the #transaction method on <code>saved_data</code>. We use the fetch method to retrieve the value of a particular key (<code>:key_name</code>). The <code>default</code> option is what we will return if no such key is present. Great!</p>

<p>So why do we have to do this in a transaction? If you try with the transaction, Ruby returns an error. Well, from what I understand, this is to ensure that multiple processes don&rsquo;t access the same .pstore file at the same time, avoiding data being written in an incomplete or corrupted state.</p>

<h3>Conclusion: PSTORE is rad and I also I don&rsquo;t fully understand it</h3>

<p>My understanding of PSTORE is way more advanced than it was a few short days ago, but it&rsquo;s still not&hellip;great. There&rsquo;s something called &lsquo;commit&rsquo;, which seems to be a method of finalising the tasks being done in a transaction, but I haven&rsquo;t figured it all out yet. But I&rsquo;ll keep trying.</p>

<p>I guess I&rsquo;m no longer a prehistoric human, staring at a fire and failing to understand what it is. I know what fire is. I think. I just don&rsquo;t know how it fully works. Or why it fully works. So, I guess in terms of of human history, I&rsquo;m somewhere in Ancient Greece.</p>

<p>And that&rsquo;s not nothing.</p>

<p><img src="http://i.imgur.com/RnGi4DZ.jpg" alt="The Ancient Greek's knowledge of fire is akin to my knowledge of PSTORE now." /></p>

<h3>Sources</h3>

<p>Roblog: <a href="https://robm.me.uk/ruby/2014/01/25/pstore.html">Persisting data in Ruby with PStore</a></p>

<p>Codebar: <a href="http://tutorials.codebar.io/ruby/lesson3/tutorial.html">The basics: Storing data - PSTORE</a></p>
]]></content>
  </entry>
  
</feed>
