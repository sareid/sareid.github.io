
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Query Params, Metadata and Pagination in Ember.js - andrew does his best</title>
  <meta name="author" content="Andrew Reid">

  
  <meta name="description" content="Query Params, Metadata and Pagination in Ember.js written in ember.js, front-end, javascript A little earlier this year, I was reading an &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://sareid.github.io/blog/2016/07/13/using-query-params-in-ember-dot-js">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="andrew does his best" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href='https://fonts.googleapis.com/css?family=Julius+Sans+One' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Crimson+Text' rel='stylesheet' type='text/css'>
  

</head>

  <body>
    <a href="/" class="home-icon">
      <img src="/images/home.png"/>
    </a>

    <article role="article" class="full-single-article">
  <div class="container">
    <div class="row">
      <div class="col-md-8 col-md-offset-2">
        <h1>Query Params, Metadata and Pagination in Ember.js</h1>
        <div class="meta">
          written 








  



<time datetime="2016-07-13T14:09:31-04:00" pubdate data-updated="true"></time>
          

in
<span class="categories">
  
    <a class='category' href='/blog/categories/ember-dot-js/'>ember.js</a>, <a class='category' href='/blog/categories/front-end/'>front-end</a>, <a class='category' href='/blog/categories/javascript/'>javascript</a>
  
</span>


        </div>
        <p>A little earlier this year, I was reading an organisation&rsquo;s style guide for working with Ember.js, when I encountered reference to the use of &lsquo;query params&rsquo; in a controller. At the time, still relatively new to Ember, I had no idea what this meant. In the intervening time, though I&rsquo;ve learned a lot. Basically, query params allow for certain application states to be serialised into the URL that wouldn&rsquo;t be otherwise possible through the regular use of routes. In this blog post, I&rsquo;m going to explain the role of query params, and how they can be used in your Ember app to provide some neat functionality. I&rsquo;ll be using a sample Ember.js front-end app, with a Rails API on the back-end.<!--more--></p>

<h3>Query Param Basics</h3>

<p>Consider the following URL: <code>http://www.fakewebsite.com/recipes?page=2</code>. The text to the right of the &lsquo;?&rsquo; is a query param - in this case &lsquo;page&rsquo;, with a value of 2. As you might guess, this url represents the second &lsquo;page&rsquo; of a longer list of recipes. If you had 1000 recipes in your database, you can understand the utility for paginating the index page into smaller chunks. The user probably finds it easier to read a smaller number of recipes, from a UX perspective it may be preferable to avoid scrolling through long lists, and if there is any heavy logic being done on the back-end, it&rsquo;s faster to simply request 10, 25 or 50 entries at a time than the full 1000. Other uses for query params can include sorting and filtering your database according to certain properties.</p>

<p>Query params are declared in the relevant controller of the route you&rsquo;re working with. So, if you want query params for a &lsquo;recipes&rsquo; route, the query params are declared in <code>app/controllers/recipes.js</code> (or the <code>controller.js</code> file in the <code>recipes</code> directory if you&rsquo;re working with pods). Specific instructions for declaring query params can be <a href="https://guides.emberjs.com/v2.6.0/routing/query-params/">found in the Ember docs</a>, but lets build out an app to see how they work.</p>

<h3>Getting started</h3>

<p>To test out query params, I built an Ember.js app that displays a list of friends with a number of properties (like name, email, phone number, age, etc). The data is served as JSON from a Rails API.</p>

<p>The finished code can be found here: <a href="https://github.com/sareid/query-params">Ember front-end</a> &amp; <a href="https://github.com/sareid/query-params-api">Rails API</a></p>

<h3>Setting up the Rails API and adding a root node</h3>

<p>I&rsquo;m not going to go into all the steps of setting up a Rails API. Sophie DeBenedetto has a great step-by-step guide for this on her blog <a href="http://www.thegreatcodeadventure.com/building-a-super-simple-rails-api/">here</a>. This app has a single model, Person, and a single route <code>people</code>. You can take a look at the <a href="https://github.com/sareid/query-params-api/blob/master/query-params-api/db/migrate/20160712181102_create_person.rb">migration file</a> to see the properties of the model.</p>

<p>To populate the database with entries, I wrote a <code>seed.rb</code> file that makes 400 instances of people using the <a href="https://github.com/stympy/faker">Faker gem</a> which automatically generates content for different types of properties, like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="mi">400</span><span class="o">.</span><span class="n">times</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">person</span> <span class="o">=</span> <span class="no">Person</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
</span><span class='line'>    <span class="ss">first_name</span><span class="p">:</span> <span class="no">Faker</span><span class="o">::</span><span class="no">Name</span><span class="o">.</span><span class="n">first_name</span><span class="p">,</span>
</span><span class='line'>    <span class="ss">last_name</span><span class="p">:</span> <span class="no">Faker</span><span class="o">::</span><span class="no">Name</span><span class="o">.</span><span class="n">last_name</span><span class="p">,</span>
</span><span class='line'>    <span class="ss">nick_name</span><span class="p">:</span> <span class="no">Faker</span><span class="o">::</span><span class="no">Superhero</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span class='line'>    <span class="ss">age</span><span class="p">:</span> <span class="no">Faker</span><span class="o">::</span><span class="no">Number</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">99</span><span class="p">),</span>
</span><span class='line'>    <span class="ss">email</span><span class="p">:</span> <span class="no">Faker</span><span class="o">::</span><span class="no">Internet</span><span class="o">.</span><span class="n">email</span><span class="p">,</span>
</span><span class='line'>    <span class="ss">phone</span><span class="p">:</span> <span class="no">Faker</span><span class="o">::</span><span class="no">PhoneNumber</span><span class="o">.</span><span class="n">phone_number</span><span class="p">,</span>
</span><span class='line'>    <span class="ss">friends_since</span><span class="p">:</span> <span class="no">Faker</span><span class="o">::</span><span class="no">Time</span><span class="o">.</span><span class="n">backward</span><span class="p">(</span><span class="mi">5004</span><span class="p">,</span> <span class="ss">:evening</span><span class="p">)</span>
</span><span class='line'>  <span class="p">)</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>There is one extra thing we need to do beyond Sophie&rsquo;s instructions: recent updates to the Active Model Serializer gem use the <code>Attributes</code> adapter for serializing JSON, which excludes the root node (eg, the name of the model). As such, we get JSON like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='json'><span class='line'><span class="p">{</span>
</span><span class='line'><span class="err">id:</span> <span class="err">1,</span>
</span><span class='line'><span class="err">first_name:</span> <span class="nt">&quot;Aiden&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">last_name:</span> <span class="nt">&quot;Stamm&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">nick_name:</span> <span class="nt">&quot;Doctor Match&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">age:</span> <span class="err">35,</span>
</span><span class='line'><span class="err">email:</span> <span class="nt">&quot;devan@predovicortiz.org&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">phone:</span> <span class="nt">&quot;562.135.0643 x8216&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">friends_since:</span> <span class="nt">&quot;2007-01-09T00:49:32.000Z&quot;</span>
</span><span class='line'><span class="p">}</span><span class="err">,</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'><span class="err">id:</span> <span class="err">2,</span>
</span><span class='line'><span class="err">first_name:</span> <span class="nt">&quot;Jamie&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">last_name:</span> <span class="nt">&quot;Boyer&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">nick_name:</span> <span class="nt">&quot;Songbird&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">age:</span> <span class="err">56,</span>
</span><span class='line'><span class="err">email:</span> <span class="nt">&quot;neva@hartmann.co&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">phone:</span> <span class="nt">&quot;(858) 284-7728&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">friends_since:</span> <span class="nt">&quot;2007-07-30T21:08:20.000Z&quot;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>For the model hook in Ember to function properly, we need a root node with the name of model. To do so, we need to instruct Rails to use the <code>JSON</code> adapter. In the <code>config/intializers</code> directory, I included a <code>serializer.rb</code> file with the following line of code:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">ActiveModelSerializers</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">adapter</span> <span class="o">=</span> <span class="ss">:json</span>
</span></code></pre></td></tr></table></div></figure>


<p>With that change, the JSON served by our API looks like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='json'><span class='line'><span class="err">people:</span> <span class="p">[</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'><span class="err">id:</span> <span class="err">1,</span>
</span><span class='line'><span class="err">first_name:</span> <span class="nt">&quot;Aiden&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">last_name:</span> <span class="nt">&quot;Stamm&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">nick_name:</span> <span class="nt">&quot;Doctor Match&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">age:</span> <span class="err">35,</span>
</span><span class='line'><span class="err">email:</span> <span class="nt">&quot;devan@predovicortiz.org&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">phone:</span> <span class="nt">&quot;562.135.0643 x8216&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">friends_since:</span> <span class="nt">&quot;2007-01-09T00:49:32.000Z&quot;</span>
</span><span class='line'><span class="p">},</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'><span class="err">id:</span> <span class="err">2,</span>
</span><span class='line'><span class="err">first_name:</span> <span class="nt">&quot;Jamie&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">last_name:</span> <span class="nt">&quot;Boyer&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">nick_name:</span> <span class="nt">&quot;Songbird&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">age:</span> <span class="err">56,</span>
</span><span class='line'><span class="err">email:</span> <span class="nt">&quot;neva@hartmann.co&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">phone:</span> <span class="nt">&quot;(858) 284-7728&quot;</span><span class="p">,</span>
</span><span class='line'><span class="err">friends_since:</span> <span class="nt">&quot;2007-07-30T21:08:20.000Z&quot;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>That&rsquo;s great for now - our API is serving JSON. Let&rsquo;s set up our Ember front-end.</p>

<h3>Building an Ember app and connecting it to the API</h3>

<p>To start, generate a new Ember app with the <code>ember new</code> command (for more, <a href="https://guides.emberjs.com/v2.6.0/getting-started/quick-start/#toc_create-a-new-application">see the Ember docs</a>).</p>

<p>In this project, I just wanted to build an index page for all the people in the database. As such, we need to set up the route, model, route handler, template and controller for &lsquo;people&rsquo; (fun note: the Inflector in Rails is smart enough to know that &lsquo;people&rsquo; is the plural of &lsquo;person&rsquo;). Run <code>ember g resource people</code>. This creates three important files: <code>app/models/person.js</code>, <code>app/routes/people.js</code>, and <code>app/templates/people.hbs</code> (as well as a file for tests). It also adds the appropriate route - if you look in your <code>app/router.js</code> file you&rsquo;ll see the following:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">&#39;ember&#39;</span><span class="p">;</span>
</span><span class='line'><span class="kr">import</span> <span class="nx">config</span> <span class="nx">from</span> <span class="s1">&#39;./config/environment&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="kr">const</span> <span class="nx">Router</span> <span class="o">=</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Router</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">location</span><span class="o">:</span> <span class="nx">config</span><span class="p">.</span><span class="nx">locationType</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="nx">Router</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">route</span><span class="p">(</span><span class="s1">&#39;people&#39;</span><span class="p">);</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="kr">export</span> <span class="k">default</span> <span class="nx">Router</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>If we run our server (<code>ember s</code>) we can navigate to <code>http://localhost:4200/people</code>. There&rsquo;s nothing there yet, of course, but it&rsquo;s a route! We need to fill out a few more things before our Ember app can actually make requests to our Rails API. First, lets build out the rest of the &lsquo;people&rsquo; resource.</p>

<p>We need to define the &lsquo;person&rsquo; model and the types of properties that will provided by our API. In <code>app\models\person.js</code> we add the following:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kr">import</span> <span class="nx">DS</span> <span class="nx">from</span> <span class="s1">&#39;ember-data&#39;</span><span class="p">;</span>
</span><span class='line'><span class="kr">import</span> <span class="nx">attr</span> <span class="nx">from</span> <span class="s1">&#39;ember-data/attr&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="kr">export</span> <span class="k">default</span> <span class="nx">DS</span><span class="p">.</span><span class="nx">Model</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">first_name</span><span class="o">:</span> <span class="nx">attr</span><span class="p">(),</span>
</span><span class='line'>  <span class="nx">last_name</span><span class="o">:</span> <span class="nx">attr</span><span class="p">(),</span>
</span><span class='line'>  <span class="nx">nick_name</span><span class="o">:</span> <span class="nx">attr</span><span class="p">(),</span>
</span><span class='line'>  <span class="nx">age</span><span class="o">:</span> <span class="nx">attr</span><span class="p">(),</span>
</span><span class='line'>  <span class="nx">email</span><span class="o">:</span> <span class="nx">attr</span><span class="p">(),</span>
</span><span class='line'>  <span class="nx">phone</span><span class="o">:</span> <span class="nx">attr</span><span class="p">(),</span>
</span><span class='line'>  <span class="nx">friends_since</span><span class="o">:</span> <span class="nx">attr</span><span class="p">(),</span>
</span><span class='line'>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>We then need to add a model hook to the &lsquo;people&rsquo; route handler that will load the model from the store. In the <code>app\routes\people.js</code> we add the following:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">&#39;ember&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="kr">export</span> <span class="k">default</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Route</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">model</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">store</span><span class="p">.</span><span class="nx">findAll</span><span class="p">(</span><span class="s1">&#39;person&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>For the moment, we don&rsquo;t need to add anything new to our controller, but we do need to fill out the <code>app/templates/people.hbs</code> template a bit. To make our front-end styling a little simpler, I&rsquo;m using the <a href="http://foundation.zurb.com/">Zurb Foundation</a> responsive framework. Don&rsquo;t worry if you don&rsquo;t understand how it works. I installed into my Ember app using the <a href="https://github.com/nadavshatz/ember-cli-foundation-sass">Ember Cli Foundation Sass addon</a>.</p>

<p>In the template, I build a table of all the people in our database using the <code>{ {#each model as |person|} }</code> helper. It looks like this (ignore the spaces between the curly braces):</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="o">&lt;</span><span class="nx">table</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="nx">thead</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">th</span><span class="o">&gt;</span><span class="nx">First</span> <span class="nx">Name</span><span class="o">&lt;</span><span class="err">/th&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">th</span><span class="o">&gt;</span><span class="nx">Last</span> <span class="nx">Name</span><span class="o">&lt;</span><span class="err">/th&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">th</span><span class="o">&gt;</span><span class="nx">Nickname</span><span class="o">&lt;</span><span class="err">/th&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">th</span><span class="o">&gt;</span><span class="nx">Age</span><span class="o">&lt;</span><span class="err">/th&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">th</span><span class="o">&gt;</span><span class="nx">Email</span><span class="o">&lt;</span><span class="err">/th&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">th</span><span class="o">&gt;</span><span class="nx">Phone</span><span class="o">&lt;</span><span class="err">/th&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">th</span><span class="o">&gt;</span><span class="nx">Friends</span> <span class="nx">Since</span><span class="o">&lt;</span><span class="err">/th&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="err">/thead&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="nx">tbody</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="p">{</span> <span class="p">{</span><span class="err">#</span><span class="nx">each</span> <span class="nx">model</span> <span class="nx">as</span> <span class="o">|</span><span class="nx">person</span><span class="o">|</span><span class="p">}</span> <span class="p">}</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">tr</span><span class="o">&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">td</span><span class="o">&gt;</span><span class="p">{</span> <span class="p">{</span><span class="nx">person</span><span class="p">.</span><span class="nx">first_name</span><span class="p">}</span> <span class="p">}</span><span class="o">&lt;</span><span class="err">/td&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">td</span><span class="o">&gt;</span><span class="p">{</span> <span class="p">{</span><span class="nx">person</span><span class="p">.</span><span class="nx">last_name</span><span class="p">}</span> <span class="p">}</span><span class="o">&lt;</span><span class="err">/td&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">td</span><span class="o">&gt;</span><span class="p">{</span> <span class="p">{</span><span class="nx">person</span><span class="p">.</span><span class="nx">nick_name</span><span class="p">}</span> <span class="p">}</span><span class="o">&lt;</span><span class="err">/td&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">td</span><span class="o">&gt;</span><span class="p">{</span> <span class="p">{</span><span class="nx">person</span><span class="p">.</span><span class="nx">age</span><span class="p">}</span> <span class="p">}</span><span class="o">&lt;</span><span class="err">/td&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">td</span><span class="o">&gt;</span><span class="p">{</span> <span class="p">{</span><span class="nx">person</span><span class="p">.</span><span class="nx">email</span><span class="p">}</span> <span class="p">}</span><span class="o">&lt;</span><span class="err">/td&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">td</span><span class="o">&gt;</span><span class="p">{</span> <span class="p">{</span><span class="nx">person</span><span class="p">.</span><span class="nx">phone</span><span class="p">}</span> <span class="p">}</span><span class="o">&lt;</span><span class="err">/td&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">td</span><span class="o">&gt;</span><span class="p">{</span> <span class="p">{</span><span class="nx">person</span><span class="p">.</span><span class="nx">friends_since</span><span class="p">}</span> <span class="p">}</span><span class="o">&lt;</span><span class="err">/td&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="err">/tr&gt;</span>
</span><span class='line'>    <span class="p"></span>
</span><span class='line'>  <span class="o">&lt;</span><span class="err">/tbody&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="err">/table&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>If we navigate to <code>http://localhost:4200/people</code> we can see our table rendered with the people in our database! That&rsquo;s great. Though, with 400 entries in the database, it involves a LOT of scrolling:</p>

<div style='position:relative;padding-bottom:calc(100% / 1.60)'><iframe src='https://gfycat.com/ifr/TiredHeavyAidi' frameborder='0' scrolling='no' width='100%' height='100%' style='position:absolute;top:0;left:0;' allowfullscreen></iframe></div>


<p>Ideally, we&rsquo;d like to see things in smaller chunks - that&rsquo;s the whole point of this blog post, afterall! To do this, we need to go back to our API and include some metadata about pagination in the JSON being served.</p>

<h3>Paginating JSON and serving metadata</h3>

<p>When a GET request is sent to the <code>api/v1/people</code> route of our API, the back-end is currently serving all 400 entries back as a response. We need a way to both break the JSON being served into smaller segments, but also to serve information about the data itself (metadata). In the case of pagination, this metadata will include information like how many chunks or &lsquo;pages&rsquo; the database has been segmented into, as well as the current page being served.</p>

<p>The simplest way to incorpate pagination into your API is through the <a href="https://github.com/amatsuda/kaminari">Kaminari gem</a>. There are other options out there, but the comments I&rsquo;ve seen on Stack Overflow and elsewhere seem to favour this gem. Install it by including <code>gem 'kaminari'</code> in your Gemfile, and running <code>$ bundle</code>. With this done, we need to make some changes to our People Controller, as follows:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Api</span><span class="o">::</span><span class="no">V1</span><span class="o">::</span><span class="no">PeopleController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">index</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">info</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>      <span class="ss">page</span><span class="p">:</span> <span class="n">params</span><span class="o">[</span><span class="ss">:page</span><span class="o">]</span> <span class="o">||</span> <span class="mi">1</span><span class="p">,</span>
</span><span class='line'>      <span class="ss">per_page</span><span class="p">:</span> <span class="n">params</span><span class="o">[</span><span class="ss">:per_page</span><span class="o">]</span> <span class="o">||</span> <span class="mi">10</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="vi">@people</span> <span class="o">=</span> <span class="no">Person</span><span class="o">.</span><span class="n">page</span><span class="p">(</span><span class="n">info</span><span class="o">[</span><span class="ss">:page</span><span class="o">]</span><span class="p">)</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">info</span><span class="o">[</span><span class="ss">:per_page</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">render</span> <span class="ss">json</span><span class="p">:</span> <span class="vi">@people</span><span class="p">,</span> <span class="ss">params</span><span class="p">:</span> <span class="n">info</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>The info hash sets defaults for the current page, as well as the number of entries per page. Eventually, params included in requests from the Ember app will include the page number, which is what is being used when the Person model is being queried to create the <code>@people</code> variable being rendered as JSON. If we go to <code>http://localhost:3000/people</code>, we&rsquo;ll see that only 10 entries are being served in the JSON. If we got to <code>http://localhost:3000/api/v1/people?page=2</code> we see the next 10 in the database. Cool!</p>

<p>But that&rsquo;s not all - we also need to serve the metadata, telling the Ember app things like which page we&rsquo;re on and how many pages there currently are. Looking at the <a href="https://github.com/rails-api/active_model_serializers/blob/master/docs/howto/add_pagination_links.md#json-adapter">documentation for Active Model Serializer</a>, the solution is quite simple. In our API controller (effectively the application controller), we add the following:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">pagination_dict</span><span class="p">(</span><span class="n">object</span><span class="p">)</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>    <span class="ss">current_page</span><span class="p">:</span> <span class="n">object</span><span class="o">.</span><span class="n">current_page</span><span class="p">,</span>
</span><span class='line'>    <span class="ss">next_page</span><span class="p">:</span> <span class="n">object</span><span class="o">.</span><span class="n">next_page</span><span class="p">,</span>
</span><span class='line'>    <span class="ss">prev_page</span><span class="p">:</span> <span class="n">object</span><span class="o">.</span><span class="n">prev_page</span><span class="p">,</span> <span class="c1"># use object.previous_page when using will_paginate</span>
</span><span class='line'>    <span class="ss">total_pages</span><span class="p">:</span> <span class="n">object</span><span class="o">.</span><span class="n">total_pages</span><span class="p">,</span>
</span><span class='line'>    <span class="ss">total_count</span><span class="p">:</span> <span class="n">object</span><span class="o">.</span><span class="n">total_count</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>And in our People Controller, we make a small addition to the code rendering our JSON:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Api</span><span class="o">::</span><span class="no">V1</span><span class="o">::</span><span class="no">PeopleController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">index</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">info</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>      <span class="ss">page</span><span class="p">:</span> <span class="n">params</span><span class="o">[</span><span class="ss">:page</span><span class="o">]</span> <span class="o">||</span> <span class="mi">1</span><span class="p">,</span>
</span><span class='line'>      <span class="ss">per_page</span><span class="p">:</span> <span class="n">params</span><span class="o">[</span><span class="ss">:per_page</span><span class="o">]</span> <span class="o">||</span> <span class="mi">10</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="vi">@people</span> <span class="o">=</span> <span class="no">Person</span><span class="o">.</span><span class="n">page</span><span class="p">(</span><span class="n">info</span><span class="o">[</span><span class="ss">:page</span><span class="o">]</span><span class="p">)</span><span class="o">.</span><span class="n">per</span><span class="p">(</span><span class="n">info</span><span class="o">[</span><span class="ss">:per_page</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">render</span> <span class="ss">json</span><span class="p">:</span> <span class="vi">@people</span><span class="p">,</span> <span class="ss">params</span><span class="p">:</span> <span class="n">info</span><span class="p">,</span> <span class="ss">meta</span><span class="p">:</span> <span class="n">pagination_dict</span><span class="p">(</span><span class="vi">@people</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Our JSON now has a &lsquo;meta&rsquo; key attached to the end, like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='json'><span class='line'><span class="err">meta:</span> <span class="p">{</span>
</span><span class='line'><span class="err">current_page:</span> <span class="err">1,</span>
</span><span class='line'><span class="err">next_page:</span> <span class="err">2,</span>
</span><span class='line'><span class="err">prev_page:</span> <span class="err">null,</span>
</span><span class='line'><span class="err">total_pages:</span> <span class="err">40,</span>
</span><span class='line'><span class="err">total_count:</span> <span class="err">400</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>We&rsquo;ll be able to execute a query for this in the People route handler in Ember, giving us access to this metadata in the view. So, now it&rsquo;s time to head back to the Ember app!</p>

<h3>Handling metadata and pagination in Ember</h3>

<p>We need to do a number of steps to handle and use the metadata being served with our JSON in Ember. First, we go to the route handler and change the code to the following:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">&#39;ember&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="kr">export</span> <span class="k">default</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Route</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">queryParams</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">page</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">refreshModel</span><span class="o">:</span> <span class="kc">true</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">model</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">params</span><span class="p">){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">store</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;person&#39;</span><span class="p">,</span> <span class="nx">params</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>We&rsquo;ve done a couple of things here. The queryParams property includes a key called &lsquo;page&rsquo;. By setting the refreshModel property to &lsquo;true&rsquo;, any changes to the page query param will fire the model hook and make a new request to the API. So if the url is changed from <code>http://localhost:4200/people</code> to <code>http://localhost:4200/people?page=2</code>, the model will be updated automatically.</p>

<p>Next, we need to actually declare our &lsquo;page&rsquo; query param in the <code>app/controllers/people.js</code> file, and give it some logic.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kr">import</span> <span class="nx">Ember</span> <span class="nx">from</span> <span class="s1">&#39;ember&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="kr">export</span> <span class="k">default</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Controller</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">queryParams</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;page&#39;</span><span class="p">],</span>
</span><span class='line'>  <span class="nx">page</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">metaData</span><span class="o">:</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">computed</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>    <span class="kd">let</span> <span class="nx">meta</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;model.meta&#39;</span><span class="p">);</span>
</span><span class='line'>    <span class="nx">meta</span><span class="p">[</span><span class="s1">&#39;second_last&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">meta</span><span class="p">.</span><span class="nx">total_pages</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">meta</span><span class="p">[</span><span class="s1">&#39;third_last&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">meta</span><span class="p">.</span><span class="nx">total_pages</span> <span class="o">-</span> <span class="mi">2</span><span class="p">;</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">meta</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}),</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">lastThreePages</span><span class="o">:</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">computed</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;page&#39;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;metaData.total_pages&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}),</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">actions</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">nextPage</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;page&#39;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;metaData.total_pages&#39;</span><span class="p">)){</span>
</span><span class='line'>        <span class="kd">let</span> <span class="nx">page</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;page&#39;</span><span class="p">);</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;page&#39;</span><span class="p">,</span> <span class="nx">page</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">prevPage</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;page&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;page&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;page&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>So what&rsquo;s going on here? First, the <code>queryParams</code> array is defining which specific query params we&rsquo;ll be using. In this case, just one: &lsquo;page&rsquo;. The &lsquo;page&rsquo; property below it gives it a default value of 1 - so if we navigate to just <code>http://localhost:4200/people</code>, it will assume we want the first page.</p>

<p>In the <code>metaData</code> computed property, we are accessing the information in the &lsquo;meta&rsquo; key in the JSON our API is serving, giving us access in the view to information like the current page, which we can invoke with <code>metaData.current_page</code>.</p>

<p>There are also a pair of actions: <code>nextPage</code> and <code>prevPage</code>. These do pretty much what you&rsquo;re thinking they will: when triggered, it will change the &lsquo;page&rsquo; query param to the next or previous page, thus updating the model and serving new entries from the database in our view. In the template we&rsquo;ll have two buttons that trigger these actions. We use conditional statements to make sure we can&rsquo;t advance past the last page in the database, or to a page number lower than 1.</p>

<p>Don&rsquo;t worry about the &lsquo;lastThreePages&rsquo; computed property for now - I&rsquo;m adding the pagination system available in Zurb Foundation, and we&rsquo;ll use that property for some conditionals in the view to change how certain buttons are rendered depending on which page we&rsquo;re on.</p>

<p>So, let&rsquo;s add that to our <code>app/templates/people.hbs</code> files and see what we get. In the template, below the original code for the table, we add new code for pagination buttons. Normally we might choose to separate this into a component, but for time&rsquo;s sake I&rsquo;ve just included it in the template itself. The code is a bit lengthy and not particularly important to what this blog is about. If you&rsquo;d like to see it, it&rsquo;s in <a href="https://github.com/sareid/query-params/blob/master/app/templates/people.hbs">the repository here,</a> but I am also certain there are more elegant ways of doing it.</p>

<p>With that all in place, we get something that looks like this:</p>

<div style='position:relative;padding-bottom:calc(100% / 1.60)'><iframe src='https://gfycat.com/ifr/MarvelousMarvelousDogwoodclubgall' frameborder='0' scrolling='no' width='100%' height='100%' style='position:absolute;top:0;left:0;' allowfullscreen></iframe></div>


<p>As the buttons on the bottom are pressed, the &lsquo;nextPage&rsquo; function is triggered, updating the &lsquo;page&rsquo; query param and making a new request to our Rails API (again, because we set the <code>refreshModel</code> property to &lsquo;true&rsquo;). The person controller in our API takes in the page parameter in the request, queries the database and serves the appropriate data and metadata back to our Ember app. The controller takes the data for the model, extracts the metadata, and then passes it to update the view.</p>

<h3>Conclusions</h3>

<p>So that&rsquo;s a first look at query params, metadata and pagination in Ember! Don&rsquo;t forget, we can use queryParams to serialise a number of different application states into our URL beyond mere pages. We have a <code>filter</code> query param that looks at a particular property and only returns instances from the database where a condition is met. In this example, maybe we filter to find friends who are a particular age. Or we could sort according to certain categories - maybe I&rsquo;d like to see my friends ranked according to how long I&rsquo;ve known them. We can accomplish all this and more with query params.</p>


        <hr class="divider-short"/>

        
      </div>
    </div>
  </div>
</article>

<hr class="divider-short"/>

<div class="archive-link">
  <div class="container">
    <div class="row">
      <div class="col-md-8 col-md-offset-2">
        
          <a class="pull-left" href="/blog/2016/04/28/creating-page-specific-javascript-and-css-in-rails/" title="Previous Post: Creating page-specific JavaScript and CSS in Rails">&laquo; Previous: Creating page-specific JavaScript and CSS in Rails</a>
        

        
      </div>
    </div>
  </div>
</div>

    <footer id="footer" class="her-row">
  <div class="container">
    <div class="row">
      <div class="col-md-1">
  <a href="/"><h4>Home</h4></a>
</div>

<div class="col-md-2">
  <div class="social-icon-list">
    
    <a href="https://twitter.com/doeshisbest"><img src="/images/glyphicons_social_31_twitter.png"/></a>
    

    
    <a href="https://github.com/sareid"><img src="/images/glyphicons_social_21_github.png"/></a>
    

    

    
  </div>
</div>

<div class="pull-right">
  <h4>Powered by <a href="http://octopress.org/">Octopress</a>. Designed by <a href="http://AdrianArtiles.com">Adrian Artiles</a>.</h4>
</div>


    </div>
  </div>
</footer>

    
  </body>
</html>
